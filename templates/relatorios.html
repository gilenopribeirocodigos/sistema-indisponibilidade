<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relat√≥rios - Sistema de Indisponibilidade</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/relatorios.css">
</head>
<body>
    <div class="relatorio-container">
        <!-- Header -->
        <div class="relatorio-header">
            <a href="/home" class="btn-voltar">‚Üê Voltar</a>
            <h1>üìä Relat√≥rios de Disponibilidade</h1>
            <div class="user-info-mini">
                <span>{{ usuario.nome }}</span>
                <span class="badge badge-{{ usuario.perfil.lower().replace('_', '-') }}">{{ usuario.perfil }}</span>
            </div>
        </div>

        <!-- Abas -->
        <div class="tabs-container">
            <button class="tab-btn active" data-tab="geral">üìã Relat√≥rio Geral</button>
            <button class="tab-btn" data-tab="supervisor">üë• Por Supervisor</button>
        </div>

        <!-- Filtros -->
        <div class="filtros-section">
            <div class="filtro-grupo">
                <label for="tipo-periodo">üìÖ Tipo de Per√≠odo:</label>
                <select id="tipo-periodo">
                    <option value="dia">Dia Espec√≠fico</option>
                    <option value="periodo" selected>Per√≠odo</option>
                </select>
            </div>

            <div class="filtro-grupo" id="filtro-dia" style="display: none;">
                <label for="data-dia">Data:</label>
                <input type="date" id="data-dia" value="{{ hoje_iso }}">
            </div>

            <div class="filtro-grupo" id="filtro-periodo">
                <label for="data-inicio">De:</label>
                <input type="date" id="data-inicio" value="{{ inicio_mes }}">
                <label for="data-fim">At√©:</label>
                <input type="date" id="data-fim" value="{{ hoje_iso }}">
            </div>

            <button id="btn-gerar-relatorio" class="btn btn-primary">üìä Gerar Relat√≥rio</button>
        </div>

        <!-- ============================================
             TAB 1: RELAT√ìRIO GERAL
        ============================================ -->
        <div id="tab-geral" class="tab-content active">
            <!-- Info do Relat√≥rio -->
            <div id="relatorio-geral-info" class="relatorio-info" style="display: none;">
                <h2>RELAT√ìRIO DE DISPONIBILIDADE - GERAL</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <strong>Per√≠odo:</strong> <span id="geral-periodo">-</span>
                    </div>
                    <div class="info-item">
                        <strong>Total Eletricistas:</strong> <span id="geral-total-eletricistas">-</span>
                    </div>
                    <div class="info-item">
                        <strong>Total Registros:</strong> <span id="geral-total-registros">-</span>
                    </div>
                </div>
            </div>

            <!-- Tabela -->
            <div class="relatorio-tabela-container" id="container-tabela-geral" style="display: none;">
                <table class="relatorio-tabela" id="tabela-geral">
                    <thead>
                        <tr>
                            <th>Motivo</th>
                            <th>Qtde</th>
                            <th>%</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="3" class="loading">Gere um relat√≥rio para visualizar os dados</td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td><strong>Total</strong></td>
                            <td id="geral-total-qtde"><strong>-</strong></td>
                            <td><strong>100,0%</strong></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <!-- ============================================
             TAB 2: RELAT√ìRIO POR SUPERVISOR
        ============================================ -->
        <div id="tab-supervisor" class="tab-content">
            <!-- Info do Relat√≥rio -->
            <div id="relatorio-sup-info" class="relatorio-info" style="display: none;">
                <h2>RELAT√ìRIO DE DISPONIBILIDADE - POR SUPERVISOR</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <strong>Per√≠odo:</strong> <span id="sup-periodo">-</span>
                    </div>
                    <div class="info-item">
                        <strong>Total Registros:</strong> <span id="sup-total-registros">-</span>
                    </div>
                </div>
            </div>

            <!-- Tabela -->
            <div class="relatorio-tabela-container" id="container-tabela-sup" style="display: none;">
                <div style="overflow-x: auto;">
                    <table class="relatorio-tabela tabela-wide" id="tabela-supervisor">
                        <thead>
                            <tr id="cabecalho-supervisor">
                                <th>Supervisor</th>
                                <th>Presentes</th>
                                <th>Atestado M√©dico</th>
                                <th>Falta Injustificada</th>
                                <th>Viatura com Defeito</th>
                                <th>Viatura em Manuten√ß√£o</th>
                                <th>Acidente</th>
                                <th>Treinamento</th>
                                <th>F√©rias</th>
                                <th>Licen√ßa</th>
                                <th>Outro</th>
                                <th>Total</th>
                                <th class="col-percentual">% Presentes</th>
                                <th class="col-percentual">% Atestado M√©dico</th>
                                <th class="col-percentual">% Falta Injustificada</th>
                                <th class="col-percentual">% Viatura com Defeito</th>
                                <th class="col-percentual">% Viatura em Manuten√ß√£o</th>
                                <th class="col-percentual">% Acidente</th>
                                <th class="col-percentual">% Treinamento</th>
                                <th class="col-percentual">% F√©rias</th>
                                <th class="col-percentual">% Licen√ßa</th>
                                <th class="col-percentual">% Outro</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="22" class="loading">Gere um relat√≥rio para visualizar os dados</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer-relatorio">
            <p>Sistema de Indisponibilidade - DPL Constru√ß√µes | Equatorial Energia</p>
            <p>Gerado em: <span id="data-geracao">-</span></p>
        </div>
    </div>

    <script src="/static/js/relatorios.js"></script>
</body>
</html>
